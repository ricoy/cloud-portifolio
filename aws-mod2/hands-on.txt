AWS - M√≥dulo 2: Solu√ß√£o

Parte 1:

‚Ä¢ Script de automa√ß√£o/cria√ß√£o dos usu√°rios (AWS CLI)
‚Ä¢ Converter a planilha de usu√°rios de acordo com script (Nomes das Colunas | Formato: CSV)
‚Ä¢ Executar script de automa√ß√£o
‚Ä¢ Validar cria√ß√£o dos usu√°rios


# Verificar os grupos criados e criar grupo para 'Estagiarios':
‚Ä¢ CloudAdmin
‚Ä¢ DBA
‚Ä¢ LinuxAdmin
‚Ä¢ RedesAdmin
‚Ä¢ Estagiarios: ReadOnlyAccess [Policy]


# Criar pasta (aws-mod2) e baixar os arquivos:

aws-iam-cria-usuario.sh, EquipeTIABCEmpresa.xlsx e  force_mfa_policy.txt

Link para baixar o script:

https://tcb-bootcamps.s3.amazonaws.com/bootcamp-aws/pt/module2/aws-iam-cria-usuario.sh

# Ajustar da Planilha 'EquipeTIABCEmpresa.xlsx':

‚Ä¢ Remover Coluna Nome
‚Ä¢ Remover "@abcempresa.com" da coluna Email
‚Ä¢ Renomear Coluna Email para 'usuarios'
‚Ä¢ Coluna Equipe Renomear conteudo para refletir nome do 'grupo' da AWS
‚Ä¢ Renomer Coluna Equipe para 'group'
‚Ä¢ Adicionar Coluna 'senha': MeMuda123456!

‚ñ∫ Salvar Como... CSV Format [ CSV (Comma Demilited) (*.csv) ]

usuarios

‚ñ∫ Remover linhas..testar apenas 4 usu√°rios!

Save As... CSV Format [ CSV (Comma Demilited) (*.csv) ]
usuarios2

# AWS Cloud Shell  [ j√° vem com o AWS CLI instalado! ]

1. Acessar AWS Cloud Shell

2. Instalar 'dos2unix' no AWS Cloud Shell (necess√°rio para execu√ß√£o do script)

sudo yum install dos2unix -y

3. Download do script no AWS Cloud Shell

wget https://tcb-bootcamps.s3.amazonaws.com/bootcamp-aws/pt/module2/aws-iam-cria-usuario.sh

4. Configurar permiss√£o do arquivo script para que se torne "execut√°vel"

chmod +x aws-iam-cria-usuario.sh

5. Upload do arquivo 'usuarios2.csv' para AWS Cloud Shell

cat usuarios2.csv

6. Executar o script para cria√ß√£o dos usu√°rios:

./aws-iam-cria-usuario.sh usuarios2.csv

Validar os Usu√°rios criados na Console AWS | IAM


# Adicionar Pol√≠tica para permitir que os usu√°rios possam alterar suas senhas:

Acesse o Grupo | Permission | Add Permission/Attaach Police [ Filtrar por 'IAM']

IAMUserChangePassword

# Testar acesso com um dos usu√°rios criados (DBA):

‚Ä¢ IAM | Dashboard | copy URL
‚Ä¢ Abra uma aba 'an√¥nima|privada' em outro navegador e acesse com a URL   [ MeMuda123456! para MeMuda123456!@ ]

---------------------------------------

Parte 2: Melhores Pr√°ticas de Seguran√ßa

‚Ä¢ Habilitar MFA no 'seu usu√°rio Root'
‚Ä¢ Criar e atachar a pol√≠tica 'EnforceMFAPolicy' nos grupos
‚Ä¢ Aplicar Politica de Senha na sua conta! [ IAM | Account settings ]

# Habilitar MFA no seu usu√°rio Root
‚Ä¢ Baixar aplictivo de autentica√ß√£o: Google Authenticador
‚Ä¢ Gerar token e validar acesso usando um segundo fator de autentica√ß√£o

Activate MFA | Virtual MFA device
Abra o autenticador e adicione uma 'conta' | Leia QRCode | Aguarde gerar dois tokens consecutivos

Agora al√©m de usarmos "usu√°rio/senha" ser√° necess√°rio tamb√©m o uso do Token gerado pelo Aplicativo!
++camadaSeguran√ßa! üî•üöÄ


# Adicionar MFA para os usu√°rios:

Polices | Create Policy
JSON: remover o c√≥digo que existe e colar do arquivo disponibilizado!
Next | Review | Name: EnforceMFAPolicy
Aplicar a Pol√≠tica em todos os Grupos


# 'Change Password Policy' Aplicar Politica de Senha | Tornar Senha mais Forte!!

# Testar acesso dos usu√°rios!

MeMuda123456! | MeMuda123456!@

# Login com usu√°rio | Ativa√ß√£o MFA

Clique no nome do usu√°rio logado | Security Credentials
MFA device
Gerar os tokens
Ap√≥s habilitar 'MFA' fa√ßa Loggof/Login


# Evid√™ncia

| Usu√°rios Criados
| MFA Virtual Enable
| Last Activity (acesso feito com os usu√°rios criados)


TCB üöÄ